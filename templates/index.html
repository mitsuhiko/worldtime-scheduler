{% extends 'layout.html' %}
{% block title %}Welcome{% endblock %}
{% block body %}
  <p>
    Want to schedule a meeting that spans multiple timezones?  This handy
    little website can help you with that.  Just add the names of the timezones
    or cities and select your time slots.

  {% raw %}
  <div class="container timezone-table" ng-controller="TimezoneTableCtrl">
    <div class="navbar">
      <div class="navbar-inner schedule-bar">
        <a class="brand">Schedule</a>
        <div class="navbar-text navbar-caption pull-left">City:</div>
        <form class="navbar-form pull-left" ng-controller="CityTypeaheadCtrl"
              ng-submit="addSuggestedRow()">
          <div class="control-group" ng-class="{error: cityFailed}">
            <input type="text" class="span3" autocomplete=off name=city ng-model="city"
              typeahead="state for state in getSuggestions($viewValue)">
            <button type="submit" class="btn">Add</button>
          </div>
        </form>
        <div class="navbar-text navbar-caption pull-left">Date:</div>
        <form class="navbar-form pull-left">
          <div class="input-append" id="datepicker" data-date="{{ selectedDay }}">
            <input class="span2" type="text" value="{{ selectedDay }}" readonly>
            <span class="add-on"><i class="icon-calendar"></i></span>
          </div>
        </form>
        <ul class="nav pull-right">
          <li class="dropdown">
            <a class="dropdown-toggle">
              Actions
              <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
              <li><a ng-click="sortByOffset()">Sort by offset</a>
              <li><a ng-click="sortByName()">Sort by name</a>
              <li class="divider">
              <li><a>Copy to clipboard</a>
              <li><a>Link to this table</a>
            </ul>
        </ul>
      </div>
    </div>

    <ul class="timetable" ui-sortable="{axis: 'y', handle: 'td.handle', cursor: 'row-resize'}" ng-model="rows">
      <li ng-repeat="row in rows" class="time-row" ng-class="{home: row.isHome}">
        <table>
          <tr class="cells">
            <td class="handle"><div></div>
            <td class="offset"><span
                tooltip-placement="bottom"
                tooltip="{{ row.offsets|describeoffset }}"><em>{{ row.offsets|offsetformat }}</em></span>
            <th class="location">
              <li class="dropdown">
                <a class="dropdown-toggle locationname">{{ row.city.name }}</a>
                <ul class="dropdown-menu">
                  <li><a ng-click="setAsHome(row.city.key)" ng-hide="row.isHome">Set as home</a>
                  <li><a ng-click="removeRow(row.city.key)">Remove</a>
                </ul>
              </li>
              <span class="country">{{ row.city.country }}</span>
              <span class="zones">
                <em ng-repeat="zone in row.zones"
                  tooltip-placement="bottom"
                  tooltip="{{ zone|describezone }}">{{ zone.name }}</em>
              </span>
            <td ng-repeat="cell in row.cells" class="slotwrapper">
              <div class=slot ng-class="{
                  night: cell.slot.hour >= 22 || cell.slot.hour < 6,
                  morning: cell.slot.hour >= 6 && cell.slot.hour < 8,
                  day: cell.slot.hour >= 8 && cell.slot.hour < 18,
                  evening: cell.slot.hour >= 18 && cell.slot.hour < 22
                }">
                <span class=hour>{{ cell.slot.hour }}</span>
                <span class=minute>{{ cell.slot.minute|padint:2 }}</span>
              </div>
        </table>
    </ul>
  </div>
  {% endraw %}
{% endblock %}
